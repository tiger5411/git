Core GIT Translations
=====================

This directory holds the translations for the core of Git. This
document describes how to add to and maintain these translations.


Generating a .pot file
----------------------

The po/git.pot file contains a message catalog extracted from Git's
sources. You need to generate it to add new translations with
msginit(1), or update existing ones with msgmerge(1).

Since the file can be automatically generated it's not checked into
git.git. To generate it do, at the top-level:

    make pot


Initializing a .po file
-----------------------

To add a new translation first generate git.pot (see above) and then
in the po/ directory do:

    msginit --locale=XX --no-translator

Where XX is your locale, e.g. "is", "de" or "pt_BR".

Then, because msginit(1) will include a lot of superfluous info we
don't want run this on it:

    perl -ni -e '
        if (1 .. /^$/) {
            s/^#.*\n//;
            s/(?<=Project-Id-Version: )PACKAGE VERSION/Git/;
            s/"(?:PO-Revision-Date|Language-Team|Last-Translator): .*\n//;
        }
        s/^#: .*\n//;
        print
    ' XX.po

We omit removing "POT-Creation-Date", because msgmerge(1) always adds
it if it isn't present, and removing it after each msgmerge is harder
than just including it to begin with.


Updating a .po file
-------------------

If there's an existing *.po file for your language but you need to
update the translation you first need to generate git.pot (see above)
and then in the po/ directory do:

    msgmerge --no-location --backup=off -U XX.po git.pot

Where XX.po is the file you want to update.

If you want to generate location comments (it can be very useful to
see the source for context while translating) do:

    msgmerge --add-location --backup=off -U XX.po git.pot

But then you need remember to remove the comments before you submit
the file upstream:

    perl -pi -e 's/^#: .*\n//' XX.po


Testing your changes
--------------------

Before you submit your changes go back to the top-level and do:

    make

On systems with GNU gettext (i.e. not Solaris) this will compile your
changed PO file with `msgfmt --check`, the --check option flags many
common errors, e.g. missing printf format strings, or translated
messages that deviate from the originals in whether they begin/end
with a newline or not.
